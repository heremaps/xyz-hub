var JsonPathRFC9535=(()=>{var ye=Object.defineProperty;var Qn=Object.getOwnPropertyDescriptor;var Rn=Object.getOwnPropertyNames;var qn=Object.prototype.hasOwnProperty;var zn=(n,a,r)=>a in n?ye(n,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[a]=r;var Mn=(n,a)=>{for(var r in a)ye(n,r,{get:a[r],enumerable:!0})},Kn=(n,a,r,o)=>{if(a&&typeof a=="object"||typeof a=="function")for(let u of Rn(a))!qn.call(n,u)&&u!==r&&ye(n,u,{get:()=>a[u],enumerable:!(o=Qn(a,u))||o.enumerable});return n};var Bn=n=>Kn(ye({},"__esModule",{value:!0}),n);var xe=(n,a,r)=>zn(n,typeof a!="symbol"?a+"":a,r);var ca={};Mn(ca,{batchExec:()=>ua,exec:()=>mt,paths:()=>la,query:()=>oa});function Un(n,a){function r(){this.constructor=n}r.prototype=a.prototype,n.prototype=new r}function B(n,a,r,o){var u=Error.call(this,n);return Object.setPrototypeOf&&Object.setPrototypeOf(u,B.prototype),u.expected=a,u.found=r,u.location=o,u.name="SyntaxError",u}Un(B,Error);function Me(n,a,r){return r=r||" ",n.length>a?n:(a-=n.length,r+=r.repeat(a),n+r.slice(0,a))}B.prototype.format=function(n){var a="Error: "+this.message;if(this.location){var r=null,o;for(o=0;o<n.length;o++)if(n[o].source===this.location.source){r=n[o].text.split(/\r\n|\n|\r/g);break}var u=this.location.start,h=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(u):u,x=this.location.source+":"+h.line+":"+h.column;if(r){var S=this.location.end,T=Me("",h.line.toString().length," "),$=r[u.line-1],d=u.line===S.line?S.column:$.length+1,C=d-u.column||1;a+=` --> `+x+` `+T+` | `+h.line+" | "+$+` `+T+" | "+Me("",u.column-1," ")+Me("",C,"^")}else a+=` at `+x}return a};B.buildMessage=function(n,a){var r={literal:function($){return'"'+u($.text)+'"'},class:function($){var d=$.parts.map(function(C){return Array.isArray(C)?h(C[0])+"-"+h(C[1]):h(C)});return"["+($.inverted?"^":"")+d.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function($){return $.description}};function o($){return $.charCodeAt(0).toString(16).toUpperCase()}function u($){return $.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(d){return"\\x0"+o(d)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(d){return"\\x"+o(d)})}function h($){return $.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(d){return"\\x0"+o(d)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(d){return"\\x"+o(d)})}function x($){return r[$.type]($)}function S($){var d=$.map(x),C,_;if(d.sort(),d.length>0){for(C=1,_=1;C<d.length;C++)d[C-1]!==d[C]&&(d[_]=d[C],_++);d.length=_}switch(d.length){case 1:return d[0];case 2:return d[0]+" or "+d[1];default:return d.slice(0,-1).join(", ")+", or "+d[d.length-1]}}function T($){return $?'"'+u($)+'"':"end of input"}return"Expected "+S(n)+" but "+T(a)+" found."};function et(n,a){a=a!==void 0?a:{};var r={},o=a.grammarSource,u={jsonpath_query:Pe},h=Pe,x="$",S=".",T="..",$="[",d=",",C="]",_="*",L=":",vt="?",ue='"',ce="'",$t="0",dt="-",pe="||",er="\\",rr="u",ge="&&",Oe="d",tr="(",sr=")",yt="!",nr="==",ar="!=",ir="<=",fr=">=",or="-0",lr="true",ur="false",cr="null",xt="@",At="e",bt=/^[\t-\n\r ]/,Ct=/^[A-Z_a-z\x80-\uD7FF\uE000-\uFFFF]/,pr=/^[\uD800-\uDBFF]/,gr=/^[\uDC00-\uDFFF]/,Et=/^[A-Za-z]/,wt=/^[0-9]/,St=/^[1-9]/,Ft=/^[ -!#-&(-[\]-\uD7FF\uE000-\uFFFF]/,Nt=/^[\/\\bfnrt]/,_t=/^[A-CE-F]/i,Ot=/^[0-7]/,Tt=/^[8-9]/,jt=/^[A-B]/i,kt=/^[C-F]/i,Lt=/^[A-F]/i,Pt=/^[<>]/,Dt=/^[0-9_a-z]/,It=/^[+\-]/,Vt=/^[a-z]/,Wt=b("$",!1),Qt=F([[" ",` `],"\r"," "],!1,!1),Te=b(".",!1),Rt=b("..",!1),je=b("[",!1),he=b(",",!1),ke=b("]",!1),qt=b("*",!1),zt=F([["A","Z"],"_",["a","z"],["\x80","\uD7FF"],["\uE000","\uFFFF"]],!1,!1),hr=F([["\uD800","\uDBFF"]],!1,!1),mr=F([["\uDC00","\uDFFF"]],!1,!1),vr=b(":",!1),Mt=b("?",!1),Kt=F([["A","Z"],["a","z"]],!1,!1),Bt=F([["0","9"]],!1,!1),me=b('"',!1),ve=b("'",!1),Ut=b("0",!1),Gt=b("-",!1),Ht=F([["1","9"]],!1,!1),$r=b("||",!1),Jt=F([[" ","!"],["#","&"],["(","["],["]","\uD7FF"],["\uE000","\uFFFF"]],!1,!1),dr=b("\\",!1),Zt=F(["/","\\","b","f","n","r","t"],!1,!1),yr=b("u",!1),xr=b("&&",!1),Xt=F([["A","C"],["E","F"]],!1,!0),Le=b("D",!0),Yt=F([["0","7"]],!1,!1),es=F([["8","9"]],!1,!1),rs=F([["A","B"]],!1,!0),ts=F([["C","F"]],!1,!0),Ar=b("(",!1),br=b(")",!1),ss=F([["A","F"]],!1,!0),ns=b("!",!1),as=b("==",!1),is=b("!=",!1),fs=b("<=",!1),os=b(">=",!1),ls=F(["<",">"],!1,!1),us=b("-0",!1),cs=b("true",!1),ps=b("false",!1),gs=b("null",!1),hs=b("@",!1),ms=F([["0","9"],"_",["a","z"]],!1,!1),vs=b("e",!0),$s=F(["+","-"],!1,!1),ds=F([["a","z"]],!1,!1),ys=function(e){return{type:"JsonPathQuery",segments:e}},Cr=function(e){return e},xs=function(e){return e},As=function(e){return{type:"ChildSegment",node:e}},bs=function(e){return{type:"DescendantSegment",node:e}},Er=function(e,t){return t},Cs=function(e,t){return[e,...t]},Es=function(e){return{type:"BracketedSelection",selectors:e}},ws=function(){return{type:"WildcardSelector"}},Ss=function(e){return{type:"MemberNameShorthand",value:e}},Fs=function(e){return{type:"NameSelector",value:e}},Ns=function(e,t,i){return i},_s=function(e,t,i){return{start:e,end:t,step:i}},Os=function(e){return{type:"SliceSelector",start:e.start===""?null:Number.parseInt(e.start.trim(),10),end:e.end===""?null:Number.parseInt(e.end.trim(),10),step:e.step===""||e.step===null?null:Number.parseInt(e.step.trim(),10)}},Ts=function(e){return{type:"IndexSelector",value:Number.parseInt(e,10)}},js=function(e){return{type:"FilterSelector",value:e}},ks=function(e){return e},Ls=function(e){return e},Ps=function(e){return e.join("")},Ds=function(){return'"'},Is=function(e){switch(e){case"b":return"\b";case"f":return"\f";case"n":return` `;case"r":return"\r";case"t":return" ";case"/":return"/";case"\\":return"\\";default:return e.slice(1)}},Vs=function(){return"'"},Ws=function(e){switch(e){case"b":return"\b";case"f":return"\f";case"n":return` `;case"r":return"\r";case"t":return" ";case"/":return"/";case"\\":return"\\";default:return e.slice(1)}},wr=function(e,t){return t},Qs=function(e,t){return t.length===0?e:{type:"LogicalOrExpr",left:e,right:t.length===1?t[0]:t.slice(1).reduce((i,f)=>({type:"LogicalOrExpr",left:i,right:f}),t[0])}},Sr=function(e,t){return t},Rs=function(e,t){return[e,...t]},qs=function(e){return e.length===1?e[0]:{type:"LogicalAndExpr",left:e[0],right:e.length===2?e[1]:e.slice(2).reduce((t,i)=>({type:"LogicalOrExpr",left:t,right:i}),e[1])}},zs=function(){return String.fromCharCode(Number.parseInt(cn(),16))},Ms=function(e,t){return String.fromCharCode(Number.parseInt(e,16))+String.fromCharCode(Number.parseInt(t,16))},Ks=function(e){return e},Bs=function(e,t){return e!==null?{type:"LogicalNotExpr",expression:t}:t},Us=function(e,t,i){return{type:"ComparisonExpr",left:e,op:t,right:i}},Gs=function(e,t){return e!==null?{type:"LogicalNotExpr",expression:{type:"TestExpr",expression:t}}:{type:"TestExpr",expression:t}},Hs=function(e){return{type:"FilterQuery",value:e}},Fr=function(e,t,i){return i},Js=function(e,t,i){return[t,...i]},Zs=function(e,t){return{type:"FunctionExpr",name:e,arguments:t}},Xs=function(e){return{type:"Literal",value:e}},Ys=function(e){return{type:"RelQuery",segments:e}},en=function(e){return Number(e)},rn=function(){return!0},tn=function(){return!1},sn=function(){return null},nn=function(e){return{type:"RelSingularQuery",segments:e}},an=function(e){return{type:"AbsSingularQuery",segments:e}},Nr=function(e){return{type:"SingularQuerySegment",node:e}},fn=function(e){return e},on=function(e){return e},ln=function(e){return e},un=function(e){return{type:"IndexSelector",selector:e}},s=a.peg$currPos|0,m=s,J=[{line:1,column:1}],I=s,$e=a.peg$maxFailExpected||[],p=a.peg$silentFails|0,ee;if(a.startRule){if(!(a.startRule in u))throw new Error(`Can't start parsing from rule "`+a.startRule+'".');h=u[a.startRule]}function cn(){return n.substring(m,s)}function pa(){return m}function ga(){return{source:o,start:m,end:s}}function ha(){return re(m,s)}function ma(e,t){throw t=t!==void 0?t:re(m,s),Or([gn(e)],n.substring(m,s),t)}function va(e,t){throw t=t!==void 0?t:re(m,s),hn(e,t)}function b(e,t){return{type:"literal",text:e,ignoreCase:t}}function F(e,t,i){return{type:"class",parts:e,inverted:t,ignoreCase:i}}function $a(){return{type:"any"}}function pn(){return{type:"end"}}function gn(e){return{type:"other",description:e}}function _r(e){var t=J[e],i;if(t)return t;if(e>=J.length)i=J.length-1;else for(i=e;!J[--i];);for(t=J[i],t={line:t.line,column:t.column};i<e;)n.charCodeAt(i)===10?(t.line++,t.column=1):t.column++,i++;return J[e]=t,t}function re(e,t,i){var f=_r(e),l=_r(t),g={source:o,start:{offset:e,line:f.line,column:f.column},end:{offset:t,line:l.line,column:l.column}};return i&&o&&typeof o.offset=="function"&&(g.start=o.offset(g.start),g.end=o.offset(g.end)),g}function c(e){s<I||(s>I&&(I=s,$e=[]),$e.push(e))}function hn(e,t){return new B(e,null,null,t)}function Or(e,t,i){return new B(B.buildMessage(e,t),e,t,i)}function Pe(){var e,t,i;return e=s,t=Tr(),t!==r?(i=jr(),m=e,e=ys(i)):(s=e,e=r),e}function Tr(){var e;return n.charCodeAt(s)===36?(e=x,s++):(e=r,p===0&&c(Wt)),e}function jr(){var e,t,i,f;for(e=[],t=s,i=A(),f=kr(),f!==r?(m=t,t=Cr(f)):(s=t,t=r);t!==r;)e.push(t),t=s,i=A(),f=kr(),f!==r?(m=t,t=Cr(f)):(s=t,t=r);return e}function A(){var e,t;for(e=[],t=Lr();t!==r;)e.push(t),t=Lr();return e}function kr(){var e;return e=mn(),e===r&&(e=vn()),e}function Lr(){var e;return e=n.charAt(s),bt.test(e)?s++:(e=r,p===0&&c(Qt)),e}function mn(){var e,t,i,f;return e=s,t=Pr(),t===r&&(t=s,n.charCodeAt(s)===46?(i=S,s++):(i=r,p===0&&c(Te)),i!==r?(f=De(),f===r&&(f=Ie()),f!==r?(m=t,t=xs(f)):(s=t,t=r)):(s=t,t=r)),t!==r&&(m=e,t=As(t)),e=t,e}function vn(){var e,t,i;return e=s,n.substr(s,2)===T?(t=T,s+=2):(t=r,p===0&&c(Rt)),t!==r?(i=Pr(),i===r&&(i=De(),i===r&&(i=Ie())),i!==r?(m=e,e=bs(i)):(s=e,e=r)):(s=e,e=r),e}function Pr(){var e,t,i,f,l,g,v,y,E,P,j;if(e=s,n.charCodeAt(s)===91?(t=$,s++):(t=r,p===0&&c(je)),t!==r){if(i=s,f=A(),l=Ve(),l!==r){for(g=[],v=s,y=A(),n.charCodeAt(s)===44?(E=d,s++):(E=r,p===0&&c(he)),E!==r?(P=A(),j=Ve(),j!==r?(m=v,v=Er(l,j)):(s=v,v=r)):(s=v,v=r);v!==r;)g.push(v),v=s,y=A(),n.charCodeAt(s)===44?(E=d,s++):(E=r,p===0&&c(he)),E!==r?(P=A(),j=Ve(),j!==r?(m=v,v=Er(l,j)):(s=v,v=r)):(s=v,v=r);m=i,i=Cs(l,g)}else s=i,i=r;i!==r?(f=A(),n.charCodeAt(s)===93?(l=C,s++):(l=r,p===0&&c(ke)),l!==r?(m=e,e=Es(i)):(s=e,e=r)):(s=e,e=r)}else s=e,e=r;return e}function De(){var e,t;return e=s,n.charCodeAt(s)===42?(t=_,s++):(t=r,p===0&&c(qt)),t!==r&&(m=e,t=ws()),e=t,e}function Ie(){var e,t,i,f,l,g;if(e=s,t=s,i=s,f=Dr(),f!==r){for(l=[],g=Ir();g!==r;)l.push(g),g=Ir();f=[f,l],i=f}else s=i,i=r;return i!==r?t=n.substring(t,s):t=i,t!==r&&(m=e,t=Ss(t)),e=t,e}function Ve(){var e;return e=Vr(),e===r&&(e=De(),e===r&&(e=$n(),e===r&&(e=Wr(),e===r&&(e=dn())))),e}function Dr(){var e,t,i;return e=n.charAt(s),Ct.test(e)?s++:(e=r,p===0&&c(zt)),e===r&&(e=s,t=n.charAt(s),pr.test(t)?s++:(t=r,p===0&&c(hr)),t!==r?(i=n.charAt(s),gr.test(i)?s++:(i=r,p===0&&c(mr)),i!==r?(t=[t,i],e=t):(s=e,e=r)):(s=e,e=r)),e}function Ir(){var e;return e=Dr(),e===r&&(e=R()),e}function Vr(){var e,t;return e=s,t=Qr(),t!==r&&(m=e,t=Fs(t)),e=t,e}function $n(){var e,t,i,f,l,g,v,y,E,P,j,V;return e=s,t=s,i=s,f=s,l=te(),l!==r?(g=A(),l=[l,g],f=l):(s=f,f=r),f===r&&(f=null),i=n.substring(i,s),n.charCodeAt(s)===58?(f=L,s++):(f=r,p===0&&c(vr)),f!==r?(l=A(),g=s,v=s,y=te(),y!==r?(E=A(),y=[y,E],v=y):(s=v,v=r),v===r&&(v=null),g=n.substring(g,s),v=s,n.charCodeAt(s)===58?(y=L,s++):(y=r,p===0&&c(vr)),y!==r?(E=s,P=s,j=A(),V=te(),V===r&&(V=null),j=[j,V],P=j,E=n.substring(E,s),m=v,v=Ns(i,g,E)):(s=v,v=r),v===r&&(v=null),m=t,t=_s(i,g,v)):(s=t,t=r),t!==r&&(m=e,t=Os(t)),e=t,e}function Wr(){var e,t,i;return e=s,t=s,i=te(),i!==r?t=n.substring(t,s):t=i,t!==r&&(m=e,t=Ts(t)),e=t,e}function dn(){var e,t,i,f;return e=s,n.charCodeAt(s)===63?(t=vt,s++):(t=r,p===0&&c(Mt)),t!==r?(i=A(),f=We(),f!==r?(m=e,e=js(f)):(s=e,e=r)):(s=e,e=r),e}function da(){var e;return e=n.charAt(s),Et.test(e)?s++:(e=r,p===0&&c(Kt)),e}function R(){var e;return e=n.charAt(s),wt.test(e)?s++:(e=r,p===0&&c(Bt)),e}function Qr(){var e,t,i,f,l;if(e=s,t=s,n.charCodeAt(s)===34?(i=ue,s++):(i=r,p===0&&c(me)),i!==r){for(f=[],l=Rr();l!==r;)f.push(l),l=Rr();n.charCodeAt(s)===34?(l=ue,s++):(l=r,p===0&&c(me)),l!==r?(m=t,t=ks(f)):(s=t,t=r)}else s=t,t=r;if(t===r)if(t=s,n.charCodeAt(s)===39?(i=ce,s++):(i=r,p===0&&c(ve)),i!==r){for(f=[],l=qr();l!==r;)f.push(l),l=qr();n.charCodeAt(s)===39?(l=ce,s++):(l=r,p===0&&c(ve)),l!==r?(m=t,t=Ls(f)):(s=t,t=r)}else s=t,t=r;return t!==r&&(m=e,t=Ps(t)),e=t,e}function te(){var e,t,i,f,l;if(n.charCodeAt(s)===48?(e=$t,s++):(e=r,p===0&&c(Ut)),e===r)if(e=s,n.charCodeAt(s)===45?(t=dt,s++):(t=r,p===0&&c(Gt)),t===r&&(t=null),i=yn(),i!==r){for(f=[],l=R();l!==r;)f.push(l),l=R();t=[t,i,f],e=t}else s=e,e=r;return e}function Rr(){var e,t,i;return e=s,t=zr(),t!==r?e=n.substring(e,s):e=t,e===r&&(n.charCodeAt(s)===39?(e=ce,s++):(e=r,p===0&&c(ve)),e===r&&(e=s,t=de(),t!==r?(n.charCodeAt(s)===34?(i=ue,s++):(i=r,p===0&&c(me)),i!==r?(m=e,e=Ds()):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,t=de(),t!==r?(i=Mr(),i!==r?(m=e,e=Is(i)):(s=e,e=r)):(s=e,e=r)))),e}function qr(){var e,t,i;return e=s,t=zr(),t!==r?e=n.substring(e,s):e=t,e===r&&(n.charCodeAt(s)===34?(e=ue,s++):(e=r,p===0&&c(me)),e===r&&(e=s,t=de(),t!==r?(n.charCodeAt(s)===39?(i=ce,s++):(i=r,p===0&&c(ve)),i!==r?(m=e,e=Vs()):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,t=de(),t!==r?(i=Mr(),i!==r?(m=e,e=Ws(i)):(s=e,e=r)):(s=e,e=r)))),e}function yn(){var e;return e=n.charAt(s),St.test(e)?s++:(e=r,p===0&&c(Ht)),e}function We(){var e,t,i,f,l,g,v,y;if(e=s,t=Qe(),t!==r){for(i=[],f=s,l=A(),n.substr(s,2)===pe?(g=pe,s+=2):(g=r,p===0&&c($r)),g!==r?(v=A(),y=Qe(),y!==r?(m=f,f=wr(t,y)):(s=f,f=r)):(s=f,f=r);f!==r;)i.push(f),f=s,l=A(),n.substr(s,2)===pe?(g=pe,s+=2):(g=r,p===0&&c($r)),g!==r?(v=A(),y=Qe(),y!==r?(m=f,f=wr(t,y)):(s=f,f=r)):(s=f,f=r);m=e,e=Qs(t,i)}else s=e,e=r;return e}function zr(){var e,t,i;return e=n.charAt(s),Ft.test(e)?s++:(e=r,p===0&&c(Jt)),e===r&&(e=s,t=n.charAt(s),pr.test(t)?s++:(t=r,p===0&&c(hr)),t!==r?(i=n.charAt(s),gr.test(i)?s++:(i=r,p===0&&c(mr)),i!==r?(t=[t,i],e=t):(s=e,e=r)):(s=e,e=r)),e}function de(){var e;return n.charCodeAt(s)===92?(e=er,s++):(e=r,p===0&&c(dr)),e}function Mr(){var e,t,i;return e=n.charAt(s),Nt.test(e)?s++:(e=r,p===0&&c(Zt)),e===r&&(e=s,n.charCodeAt(s)===117?(t=rr,s++):(t=r,p===0&&c(yr)),t!==r?(i=xn(),i!==r?(t=[t,i],e=t):(s=e,e=r)):(s=e,e=r)),e}function Qe(){var e,t,i,f,l,g,v,y,E;if(e=s,t=s,i=Re(),i!==r){for(f=[],l=s,g=A(),n.substr(s,2)===ge?(v=ge,s+=2):(v=r,p===0&&c(xr)),v!==r?(y=A(),E=Re(),E!==r?(m=l,l=Sr(i,E)):(s=l,l=r)):(s=l,l=r);l!==r;)f.push(l),l=s,g=A(),n.substr(s,2)===ge?(v=ge,s+=2):(v=r,p===0&&c(xr)),v!==r?(y=A(),E=Re(),E!==r?(m=l,l=Sr(i,E)):(s=l,l=r)):(s=l,l=r);m=t,t=Rs(i,f)}else s=t,t=r;return t!==r&&(m=e,t=qs(t)),e=t,e}function xn(){var e,t,i,f,l,g,v;return e=s,t=s,i=An(),i!==r&&(m=t,i=zs()),t=i,t===r&&(t=s,i=s,f=bn(),f!==r?i=n.substring(i,s):i=f,i!==r?(n.charCodeAt(s)===92?(f=er,s++):(f=r,p===0&&c(dr)),f!==r?(n.charCodeAt(s)===117?(l=rr,s++):(l=r,p===0&&c(yr)),l!==r?(g=s,v=Cn(),v!==r?g=n.substring(g,s):g=v,g!==r?(m=t,t=Ms(i,g)):(s=t,t=r)):(s=t,t=r)):(s=t,t=r)):(s=t,t=r)),t!==r&&(m=e,t=Ks(t)),e=t,e}function Re(){var e;return e=En(),e===r&&(e=wn(),e===r&&(e=Sn())),e}function An(){var e,t,i,f,l,g;if(e=s,t=R(),t===r&&(t=n.charAt(s),_t.test(t)?s++:(t=r,p===0&&c(Xt))),t!==r){for(i=s,f=[],l=M();l!==r;)f.push(l),f.length>=3?l=r:l=M();f.length<3?(s=i,i=r):i=f,i!==r?(t=[t,i],e=t):(s=e,e=r)}else s=e,e=r;if(e===r)if(e=s,t=n.charAt(s),t.toLowerCase()===Oe?s++:(t=r,p===0&&c(Le)),t!==r)if(i=n.charAt(s),Ot.test(i)?s++:(i=r,p===0&&c(Yt)),i!==r){for(f=s,l=[],g=M();g!==r;)l.push(g),l.length>=2?g=r:g=M();l.length<2?(s=f,f=r):f=l,f!==r?(t=[t,i,f],e=t):(s=e,e=r)}else s=e,e=r;else s=e,e=r;return e}function bn(){var e,t,i,f,l,g;if(e=s,t=n.charAt(s),t.toLowerCase()===Oe?s++:(t=r,p===0&&c(Le)),t!==r)if(i=n.charAt(s),Tt.test(i)?s++:(i=r,p===0&&c(es)),i===r&&(i=n.charAt(s),jt.test(i)?s++:(i=r,p===0&&c(rs))),i!==r){for(f=s,l=[],g=M();g!==r;)l.push(g),l.length>=2?g=r:g=M();l.length<2?(s=f,f=r):f=l,f!==r?(t=[t,i,f],e=t):(s=e,e=r)}else s=e,e=r;else s=e,e=r;return e}function Cn(){var e,t,i,f,l,g;if(e=s,t=n.charAt(s),t.toLowerCase()===Oe?s++:(t=r,p===0&&c(Le)),t!==r)if(i=n.charAt(s),kt.test(i)?s++:(i=r,p===0&&c(ts)),i!==r){for(f=s,l=[],g=M();g!==r;)l.push(g),l.length>=2?g=r:g=M();l.length<2?(s=f,f=r):f=l,f!==r?(t=[t,i,f],e=t):(s=e,e=r)}else s=e,e=r;else s=e,e=r;return e}function En(){var e,t,i,f,l,g,v;return e=s,t=s,i=Kr(),i!==r?(f=A(),i=[i,f],t=i):(s=t,t=r),t===r&&(t=null),n.charCodeAt(s)===40?(i=tr,s++):(i=r,p===0&&c(Ar)),i!==r?(f=A(),l=We(),l!==r?(g=A(),n.charCodeAt(s)===41?(v=sr,s++):(v=r,p===0&&c(br)),v!==r?(m=e,e=Bs(t,l)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function wn(){var e,t,i,f,l,g;return e=s,t=Br(),t!==r?(i=A(),f=Fn(),f!==r?(l=A(),g=Br(),g!==r?(m=e,e=Us(t,f,g)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function Sn(){var e,t,i,f;return e=s,t=s,i=Kr(),i!==r?(f=A(),i=[i,f],t=i):(s=t,t=r),t===r&&(t=null),i=Ur(),i===r&&(i=qe()),i!==r?(m=e,e=Gs(t,i)):(s=e,e=r),e}function M(){var e;return e=R(),e===r&&(e=n.charAt(s),Lt.test(e)?s++:(e=r,p===0&&c(ss))),e}function Kr(){var e;return n.charCodeAt(s)===33?(e=yt,s++):(e=r,p===0&&c(ns)),e}function Br(){var e;return e=Gr(),e===r&&(e=Nn(),e===r&&(e=qe())),e}function Fn(){var e;return n.substr(s,2)===nr?(e=nr,s+=2):(e=r,p===0&&c(as)),e===r&&(n.substr(s,2)===ar?(e=ar,s+=2):(e=r,p===0&&c(is)),e===r&&(n.substr(s,2)===ir?(e=ir,s+=2):(e=r,p===0&&c(fs)),e===r&&(n.substr(s,2)===fr?(e=fr,s+=2):(e=r,p===0&&c(os)),e===r&&(e=n.charAt(s),Pt.test(e)?s++:(e=r,p===0&&c(ls)))))),e}function Ur(){var e,t;return e=s,t=_n(),t===r&&(t=Pe()),t!==r&&(m=e,t=Hs(t)),e=t,e}function qe(){var e,t,i,f,l,g,v,y,E,P,j,V;if(e=s,t=On(),t!==r)if(n.charCodeAt(s)===40?(i=tr,s++):(i=r,p===0&&c(Ar)),i!==r){if(f=A(),l=s,g=ze(),g!==r){for(v=[],y=s,E=A(),n.charCodeAt(s)===44?(P=d,s++):(P=r,p===0&&c(he)),P!==r?(j=A(),V=ze(),V!==r?(m=y,y=Fr(t,g,V)):(s=y,y=r)):(s=y,y=r);y!==r;)v.push(y),y=s,E=A(),n.charCodeAt(s)===44?(P=d,s++):(P=r,p===0&&c(he)),P!==r?(j=A(),V=ze(),V!==r?(m=y,y=Fr(t,g,V)):(s=y,y=r)):(s=y,y=r);m=l,l=Js(t,g,v)}else s=l,l=r;l===r&&(l=null),g=A(),n.charCodeAt(s)===41?(v=sr,s++):(v=r,p===0&&c(br)),v!==r?(m=e,e=Zs(t,l)):(s=e,e=r)}else s=e,e=r;else s=e,e=r;return e}function Gr(){var e,t;return e=s,t=Tn(),t===r&&(t=Qr(),t===r&&(t=jn(),t===r&&(t=kn(),t===r&&(t=Ln())))),t!==r&&(m=e,t=Xs(t)),e=t,e}function Nn(){var e;return e=Pn(),e===r&&(e=Dn()),e}function _n(){var e,t,i;return e=s,t=Hr(),t!==r?(i=jr(),i!==r?(m=e,e=Ys(i)):(s=e,e=r)):(s=e,e=r),e}function On(){var e,t,i,f,l;if(e=s,t=s,i=Wn(),i!==r){for(f=[],l=Jr();l!==r;)f.push(l),l=Jr();i=[i,f],t=i}else s=t,t=r;return t!==r?e=n.substring(e,s):e=t,e}function ze(){var e;return e=Gr(),e===r&&(e=Ur(),e===r&&(e=qe(),e===r&&(e=We()))),e}function Tn(){var e,t,i,f,l,g;return e=s,t=s,i=s,f=te(),f===r&&(n.substr(s,2)===or?(f=or,s+=2):(f=r,p===0&&c(us))),f!==r?(l=In(),l===r&&(l=null),g=Vn(),g===r&&(g=null),f=[f,l,g],i=f):(s=i,i=r),i!==r?t=n.substring(t,s):t=i,t!==r&&(m=e,t=en(t)),e=t,e}function jn(){var e,t;return e=s,n.substr(s,4)===lr?(t=lr,s+=4):(t=r,p===0&&c(cs)),t!==r&&(m=e,t=rn()),e=t,e}function kn(){var e,t;return e=s,n.substr(s,5)===ur?(t=ur,s+=5):(t=r,p===0&&c(ps)),t!==r&&(m=e,t=tn()),e=t,e}function Ln(){var e,t;return e=s,n.substr(s,4)===cr?(t=cr,s+=4):(t=r,p===0&&c(gs)),t!==r&&(m=e,t=sn()),e=t,e}function Pn(){var e,t,i;return e=s,t=Hr(),t!==r?(i=Zr(),m=e,e=nn(i)):(s=e,e=r),e}function Dn(){var e,t,i;return e=s,t=Tr(),t!==r?(i=Zr(),m=e,e=an(i)):(s=e,e=r),e}function Hr(){var e;return n.charCodeAt(s)===64?(e=xt,s++):(e=r,p===0&&c(hs)),e}function Jr(){var e;return e=n.charAt(s),Dt.test(e)?s++:(e=r,p===0&&c(ms)),e}function In(){var e,t,i,f;if(e=s,n.charCodeAt(s)===46?(t=S,s++):(t=r,p===0&&c(Te)),t!==r){if(i=[],f=R(),f!==r)for(;f!==r;)i.push(f),f=R();else i=r;i!==r?(t=[t,i],e=t):(s=e,e=r)}else s=e,e=r;return e}function Vn(){var e,t,i,f,l;if(e=s,t=n.charAt(s),t.toLowerCase()===At?s++:(t=r,p===0&&c(vs)),t!==r){if(i=n.charAt(s),It.test(i)?s++:(i=r,p===0&&c($s)),i===r&&(i=null),f=[],l=R(),l!==r)for(;l!==r;)f.push(l),l=R();else f=r;f!==r?(t=[t,i,f],e=t):(s=e,e=r)}else s=e,e=r;return e}function Zr(){var e,t,i,f,l;for(e=s,t=[],i=s,f=A(),l=Xr(),l===r&&(l=Yr()),l!==r?(m=i,i=Nr(l)):(s=i,i=r);i!==r;)t.push(i),i=s,f=A(),l=Xr(),l===r&&(l=Yr()),l!==r?(m=i,i=Nr(l)):(s=i,i=r);return m=e,t=fn(t),e=t,e}function Wn(){var e;return e=n.charAt(s),Vt.test(e)?s++:(e=r,p===0&&c(ds)),e}function Xr(){var e,t,i,f;return e=s,n.charCodeAt(s)===91?(t=$,s++):(t=r,p===0&&c(je)),t!==r?(i=Vr(),i!==r?(n.charCodeAt(s)===93?(f=C,s++):(f=r,p===0&&c(ke)),f!==r?(m=e,e=on(i)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e===r&&(e=s,n.charCodeAt(s)===46?(t=S,s++):(t=r,p===0&&c(Te)),t!==r?(i=Ie(),i!==r?(m=e,e=ln(i)):(s=e,e=r)):(s=e,e=r)),e}function Yr(){var e,t,i,f;return e=s,n.charCodeAt(s)===91?(t=$,s++):(t=r,p===0&&c(je)),t!==r?(i=Wr(),i!==r?(n.charCodeAt(s)===93?(f=C,s++):(f=r,p===0&&c(ke)),f!==r?(m=e,e=un(i)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}if(ee=h(),a.peg$library)return{peg$result:ee,peg$currPos:s,peg$FAILED:r,peg$maxFailExpected:$e,peg$maxFailPos:I};if(ee!==r&&s===n.length)return ee;throw ee!==r&&s<n.length&&c(pn()),Or($e,I<n.length?n.charAt(I):null,I<n.length?re(I,I+1):re(I,I))}function rt(n){return et(n)}var Z=class{constructor(){xe(this,"head",null);xe(this,"tail",null);xe(this,"size",0)}push(a){let r={value:a,next:null};this.tail!==null&&(this.tail.next=r),this.tail=r,this.head===null&&(this.head=r),this.size++}pop(){if(this.head===null)return;let a=this.head.value;return this.head=this.head.next,this.head===null&&(this.tail=null),this.size--,a}};function q(n){if(typeof n!="object"||n===null)return!1;let a=Object.getPrototypeOf(n);return a===null||a===Object.prototype}var X=n=>Array.isArray(n.value),Y=n=>q(n.value);var tt=new WeakSet,w=n=>typeof n=="object"&&n!==null&&tt.has(n),st=n=>{switch(typeof n){case"string":case"number":case"boolean":return!0;case"object":return n===null||q(n)||Ke(n);default:return!1}},Ke=n=>Array.isArray(n)&&!w(n),Ae=()=>{let n=[];return tt.add(n),n},D=Symbol("Nothing");var nt={declaration:function(a,r){return w(r)?r.length:0},definition:{parameters:["NodesType"],returnType:"ValueType"}};function Gn(n){let a=0;for(let r=0;r<n.length;r++){let o=n.charCodeAt(r);(o>=0&&o<=55295||o>=57344&&o<=1114111)&&a++}return a}var at={declaration:function(a,r){return typeof r=="string"?Gn(r):Array.isArray(r)?r.length:q(r)?Object.keys(r).length:D},definition:{parameters:["ValueType"],returnType:"ValueType"}};function it(n){return n===92}function Hn(n,a){let r=!1,o=a;for(;o<n.length;){let u=n.charCodeAt(o);if(o++,it(u)){r=!0;continue}if(u===93){if(!r)break;r=!1}}return o}function Jn(n){let a=n;for(let r=0;r<n.length;r++){let o=n.charCodeAt(r);it(o)?r++:o===91?r=Hn(n,r):o===46&&(a=`${n.slice(0,r)}[^ \r]${n.slice(r+1)}`)}return a}function se({cache:n},a){let r=n.get("regexps")??{};if(n.has("regexps")||n.set("regexps",r),Object.hasOwn(r,a))return r[a];try{let o=RegExp(Jn(a),"u");return r[a]=o,o}catch{return r[a]=null,null}}var ft={declaration:function(a,r,o){return typeof r!="string"||typeof o!="string"?!1:se(a,`^${o}$`)?.test(r)===!0},definition:{parameters:["ValueType","ValueType"],returnType:"LogicalType"}};var ot={declaration:function(a,r,o){return typeof r!="string"||typeof o!="string"?!1:se(a,o)?.test(r)===!0},definition:{parameters:["ValueType","ValueType"],returnType:"LogicalType"}};var lt={declaration:function(a,r){return r.length===1?r[0]:D},definition:{parameters:["NodesType"],returnType:"ValueType"}};var Be=[];function N(n,a){return n===Be?Be:typeof a=="number"?[...n,a]:[...n,Yn(a)]}function ut(n){return n?[]:Be}var Zn=/[\u0000-\u001f'\\]/g;function Xn(n){let a=n.charCodeAt(0);switch(a){case 8:return"\\b";case 12:return"\\f";case 10:return"\\n";case 13:return"\\r";case 9:return"\\t";case 39:return"\\'";case 92:return"\\\\";default:return`\\u${a.toString(16).padStart(4,"0")}`}}function Yn(n){return n.replace(Zn,Xn)}function ct(n){let a="$";for(let r of n)typeof r=="number"?a+=`[${r}]`:a+=`['${r}']`;return a}function k(n){throw new TypeError(`Unexpected node type: ${n.type}`)}function O(n){throw new TypeError(`Unexpected comparison operator: ${n}`)}function be(n,a){throw new Error(a)}function U(n){switch(typeof n){case"object":if(n===null)return"null";if(w(n))return"NodeList";if(Ke(n))return"array";if(q(n))return"object";throw new TypeError(`Unknown type: ${n}`);case"string":return"string";case"number":return"number";case"boolean":return"boolean";default:if(n===D)return"Nothing";throw new TypeError(`Unknown type: ${n}`)}}function ea(n,a){if(n.length!==a.length)return!1;for(let r=0;r<n.length;r++)if(!W(n[r],a[r]))return!1;return!0}function ra(n,a){let r=Object.keys(n),o=Object.keys(a);if(r.length!==o.length)return!1;for(let u of r)if(!Object.hasOwn(a,u)||!W(n[u],a[u]))return!1;return!0}function W(n,a){if(U(n)!==U(a))return!1;switch(U(n)){case"string":case"number":case"boolean":case"null":return n===a;case"object":return ra(n,a);case"array":case"NodeList":return ea(n,a);default:return!1}}function Ce(n,a,r){switch(r){case"==":case">=":case"<=":return!w(n)&&!w(a)&&W(n,a);case"<":case">":return!1;case"!=":return!Ce(n,a,"==");default:O(r)}}function Ee(n,a,r){switch(r){case"==":case"<=":case">=":return w(n)&&(w(a)&&W(n,a)||a===D);case"<":case">":return!1;case"!=":return!Ee(n,a,"==");default:O(r)}}function we(n,a,r){switch(r){case"==":case"<=":case">=":return a===D||w(a)&&a.length===0;case"<":case">":return!1;case"!=":return!we(n,a,"==");default:O(r)}}function z(n,a,r){switch(r){case"==":return n===a;case"<":return typeof a=="number"&&n<a;case"!=":return!z(n,a,"==");case"<=":return z(n,a,"<")||z(n,a,"==");case">":return typeof a=="number"&&z(a,n,"<");case">=":return typeof a=="number"&&z(a,n,"<")||z(n,a,"==");default:O(r)}}function Ue(n,a,r){switch(r){case"==":case"<=":case">=":return W(n,a);case"<":case">":return!1;case"!=":return!W(n,a);default:O(r)}}function Se(n,a,r){switch(r){case"==":case"<=":case">=":return n===a;case"<":case">":return!1;case"!=":return!Se(n,a,"==");default:O(r)}}function G(n,a,r){if(typeof n!="string"||typeof a!="string")return!1;switch(r){case"==":return n===a;case"<":{let o=0;for(;n.length>o&&a.length>o;){let u=n.charCodeAt(o),h=a.charCodeAt(o);if(u===h){o++;continue}return n.charCodeAt(o)<a.charCodeAt(o)}return n.length<a.length}default:O(r)}}function pt(n,a,r){switch(r){case"==":case"<":return G(n,a,r);case"!=":return!G(n,a,"==");case"<=":return G(n,a,"<")||G(n,a,"==");case">":return G(a,n,"<");case">=":return G(a,n,"<")||G(n,a,"==");default:O(r)}}function Ge(n,a,r){let o=w(n)&&n.length===1?n[0]:n,u=U(o),h=w(a)&&a.length===1?a[0]:a;switch(u){case"string":return pt(o,h,r);case"number":return z(o,h,r);case"boolean":case"null":return Se(o,h,r);case"object":return Ue(o,h,r);case"array":return Ce(o,h,r);case"Nothing":return we(o,h,r);case"NodeList":return Ee(o,h,r);default:be(u,"Unknown type")}}function ne(n,a,r){let o=Ae();switch(r.value.type){case"RelQuery":K(n,a.root,a.value,r.value,u=>{o.push(u)});break;case"JsonPathQuery":K(n,a.root,a.root,r.value,u=>{o.push(u)});break;default:k(r.value)}return o}function He(n,a,r){switch(r.expression.type){case"FilterQuery":return ne(n,a,r.expression).length>0;case"FunctionExpr":return H(n,a,r.expression)===!0;default:k(r.expression)}}function Q(n,a,r){switch(r.type){case"LogicalNotExpr":return!Q(n,a,r.expression);case"LogicalAndExpr":return Q(n,a,r.left)&&Q(n,a,r.right);case"LogicalOrExpr":return Q(n,a,r.left)||Q(n,a,r.right);case"TestExpr":return He(n,a,r);case"ComparisonExpr":return ae(n,a,r);default:k(r)}}function Je(n,a,r){switch(r.type){case"FunctionExpr":return H(n,a,r);case"FilterQuery":return ne(n,a,r);case"LogicalNotExpr":case"LogicalAndExpr":case"LogicalOrExpr":case"TestExpr":return Q(n,a,r);case"Literal":return r.value;default:k(r)}}function ta(n){return w(n)?n.length===1?n[0]:D:n}function H(n,a,r){if(!sa(n.functions,r.name))return!1;let o=n.functions[r.name];if(o.definition.parameters.length!==r.arguments.length)return!1;let u=[];for(let h=0;h<r.arguments.length;h++){let x=Je(n,a,r.arguments[h]),S=o.definition.parameters[h];switch(S){case"ValueType":if(!w(x)&&!st(x))return!1;u.push(ta(x));break;case"NodesType":if(!w(x))return!1;u.push(x);break;case"LogicalType":if(typeof x=="boolean")u.push(x);else if(w(x))u.push(x.length>0);else return!1;break;default:be(S,"Unknown function argument type")}}return o.declaration(n,...u)}function sa(n,a){return Object.hasOwn(n,a)}function Fe(n,a,r){switch(r.type){case"Literal":return r.value;case"RelSingularQuery":case"AbsSingularQuery":{let o=r.type==="RelSingularQuery"?a.value:a.root;if(r.segments.length===0)return o;let u=Ae();return K(n,a.root,o,r,h=>{u.push(h)}),u}case"FunctionExpr":return H(n,a,r);default:k(r)}}function ae(n,a,r){let o=Fe(n,a,r.left),u=Fe(n,a,r.right);return Ge(o,u,r.op)}function Ne(n,a,r){if(r.value.type==="ComparisonExpr"){if(!ae(n,a,r.value))return}else if(!Q(n,a,r.value))return;n.stack.push({root:a.root,path:a.path,value:a.value,index:a.index+1})}function na(n,a){return n<0?a+n:n}function ie(n,a,r){let o=na(r.value,a.value.length);o>=0&&o<a.value.length&&n.stack.push({root:a.root,path:N(a.path,o),value:a.value[o],index:a.index+1})}function fe(n,{root:a,path:r,value:o,index:u},h){Object.hasOwn(o,h.value)&&n.stack.push({root:a,path:N(r,h.value),value:o[h.value],index:u+1})}function _e(n,a){return n>=0?n:a+n}function aa(n,a,r,o){let u=_e(n,o),h=_e(a,o);if(r>=0){let T=Math.min(Math.max(u,0),o),$=Math.min(Math.max(h,0),o);return[T,$]}let x=Math.min(Math.max(u,-1),o-1);return[Math.min(Math.max(h,-1),o-1),x]}function Ze(n,{root:a,path:r,value:o,index:u},h){let x=h.step??1,S=x>=0?0:o.length-1,T=x>=0?o.length:-o.length-1,$=h.start===null?S:_e(h.start,o.length),d=h.end===null?T:_e(h.end,o.length),[C,_]=aa($,d,x,o.length);if(x>0){let L=C;for(;L<_;)n.stack.push({root:a,path:N(r,L),value:o[L],index:u+1}),L+=x}else if(x<0){let L=_;for(;C<L;)n.stack.push({root:a,path:N(r,L),value:o[L],index:u+1}),L+=x}}function oe(n,{root:a,path:r,value:o,index:u}){if(Array.isArray(o))for(let h=0;h<o.length;h++)n.stack.push({root:a,path:N(r,h),value:o[h],index:u+1});else if(q(o))for(let h of Object.keys(o))n.stack.push({root:a,path:N(r,h),value:o[h],index:u+1})}function Xe(n,a,r){for(let o of r.selectors)switch(o.type){case"NameSelector":Y(a)&&fe(n,a,o);break;case"SliceSelector":X(a)&&Ze(n,a,o);break;case"IndexSelector":{X(a)&&ie(n,a,o);break}case"WildcardSelector":oe(n,a);break;case"FilterSelector":{X(a)?ia(n,a,o):Y(a)&&fa(n,a,o);break}default:k(o)}}function ia(n,{root:a,path:r,value:o,index:u},h){for(let x=0;x<o.length;x++)Ne(n,{root:a,path:N(r,x),value:o[x],index:u},h)}function fa(n,{root:a,path:r,value:o,index:u},h){for(let x of Object.keys(o))Ne(n,{root:a,path:N(r,x),value:o[x],index:u},h)}function Ye(n,{root:a,path:r,value:o,index:u},h){Object.hasOwn(o,h.value)&&n.stack.push({root:a,path:N(r,h.value),value:o[h.value],index:u+1})}function gt(n,a,r){switch(r.type){case"BracketedSelection":return Xe(n,a,r);case"WildcardSelector":return oe(n,a);case"MemberNameShorthand":Y(a)&&Ye(n,a,r);break;case"NameSelector":Y(a)&&fe(n,a,r);break;case"IndexSelector":X(a)&&ie(n,a,r);break;default:k(r)}}function K(n,a,r,o,u){let h=new Z;h.push({root:a,path:ut(n.capturePaths),value:r,index:0});let x={cache:n.cache,capturePaths:!1,functions:n.functions,regexp:n.regexp,stack:h};for(;h.size>0;){let S=h.pop();if(S.index===o.segments.length){u(S.value,S.path);continue}let{path:T,value:$,index:d}=S,C=o.segments[d];if(gt(x,S,C.node),C.type==="DescendantSegment"){if(Array.isArray($))for(let _=0;_<$.length;_++)h.push({root:a,path:N(T,_),value:$[_],index:d});else if($!==null&&typeof $=="object")for(let _ of Object.keys($))h.push({root:a,path:N(T,_),value:$[_],index:d})}}}function le(n,a,r,o){let u={cache:new Map,capturePaths:r.capturePaths,functions:{count:nt,search:ot,value:lt,match:ft,length:at},regexp:"i-regexp",stack:new Z};K(u,n,n,rt(a),o)}var ht={capturePaths:!0};function oa(n,a){let r=[];return le(n,a,{capturePaths:!1},o=>{r.push(o)}),r}function la(n,a){let r=[];return le(n,a,ht,(o,u)=>{r.push(ct(u))}),r}function mt(n,a,r){le(n,a,ht,r)}function ua(n,a,r){for(let[o,u]of a)try{mt(n,o,u)}catch(h){r?.(h instanceof Error?h:new Error(String(h)),o)}}return Bn(ca);})();